@echo off
REM –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ React Native Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
REM –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç adb reverse –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Metro bundler

echo üöÄ –ó–∞–ø—É—Å–∫ PectoranMobile Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...

REM –ü—É—Ç—å –∫ Android SDK
set ANDROID_SDK=%LOCALAPPDATA%\Android\Sdk
set ADB_PATH=%ANDROID_SDK%\platform-tools\adb.exe

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è adb
if not exist "%ADB_PATH%" (
    echo ‚ùå –û—à–∏–±–∫–∞: adb –Ω–µ –Ω–∞–π–¥–µ–Ω –ø–æ –ø—É—Ç–∏ %ADB_PATH%
    echo –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Android SDK —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –ø—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
    pause
    exit /b 1
)

REM –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /d "%~dp0\.."

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
echo.
echo üì± –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤...
"%ADB_PATH%" devices
if errorlevel 1 (
    echo ‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ adb
)

REM –ù–∞—Å—Ç—Ä–æ–π–∫–∞ adb reverse –¥–ª—è –ø–æ—Ä—Ç–∞ Metro bundler
echo.
echo üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ adb reverse (–ø–æ—Ä—Ç 8081)...
"%ADB_PATH%" reverse tcp:8081 tcp:8081
if errorlevel 1 (
    echo ‚ö†Ô∏è  –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å adb reverse (–≤–æ–∑–º–æ–∂–Ω–æ, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ)
    echo –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Metro bundler
) else (
    echo ‚úÖ adb reverse –Ω–∞—Å—Ç—Ä–æ–µ–Ω —É—Å–ø–µ—à–Ω–æ
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ Metro bundler (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
echo.
echo üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ Metro bundler...
tasklist /FI "IMAGENAME eq node.exe" /FI "WINDOWTITLE eq *metro*" 2>NUL | find /I /N "node.exe">NUL
if "%ERRORLEVEL%"=="0" (
    echo ‚ö†Ô∏è  Metro bundler —É–∂–µ –∑–∞–ø—É—â–µ–Ω. –ó–∞–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.
    echo –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C –∏ –∑–∞–∫—Ä–æ–π—Ç–µ Metro bundler, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–Ω–æ–≤–∞.
    pause
)

REM –ó–∞–ø—É—Å–∫ Metro bundler –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ
echo.
echo üåê –ó–∞–ø—É—Å–∫ Metro bundler...
start "Metro Bundler" cmd /k "npm start -- --reset-cache"

REM –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ, —á—Ç–æ–±—ã Metro –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
timeout /t 5 /nobreak >nul

REM –ó–∞–ø—É—Å–∫ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
echo.
echo ü§ñ –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...
echo –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —Å–±–æ—Ä–∫–µ...
echo.

call npm run android

if errorlevel 1 (
    echo.
    echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    echo –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã—à–µ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π
    pause
    exit /b 1
) else (
    echo.
    echo ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–æ!
    echo.
    echo üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
    echo   - –î–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –Ω–∞–∂–º–∏—Ç–µ 'R' –¥–≤–∞ —Ä–∞–∑–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
    echo   - –î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞: –Ω–∞–∂–º–∏—Ç–µ 'M' –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
    echo   - Metro bundler –∑–∞–ø—É—â–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ
)

pause

